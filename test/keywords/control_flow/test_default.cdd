/**
 * @file test_default.cdd
 * @brief default 关键字测试用例
 * 
 * 测试 default 标签的各种用法（配合 switch）
 */

// 1. 基本 default
int test_basic_default(int x) {
    switch (x) {
        case 1:
            return 1;
        default:
            return 0;
    }
}

// 2. default 在最后
int test_default_last(int x) {
    switch (x) {
        case 1:
            return 1;
        case 2:
            return 2;
        case 3:
            return 3;
        default:
            return -1;
    }
}

// 3. default 在中间
int test_default_middle(int x) {
    switch (x) {
        case 1:
            return 1;
        default:
            return 0;
        case 2:
            return 2;
    }
}

// 4. default 在开头
int test_default_first(int x) {
    switch (x) {
        default:
            return 0;
        case 1:
            return 1;
        case 2:
            return 2;
    }
}

// 5. default 带 break
int test_default_break(int x) {
    int result = 0;
    switch (x) {
        case 1:
            result = 1;
            break;
        case 2:
            result = 2;
            break;
        default:
            result = -1;
            break;
    }
    return result;
}

// 6. default 带多语句
int test_default_multi_stmt(int x) {
    int a;
    int b;
    switch (x) {
        case 1:
            a = 1;
            b = 1;
            break;
        default:
            a = -1;
            b = -1;
            a = a * 2;
            b = b * 2;
    }
    return a + b;
}

// 7. default 带大括号
int test_default_braces(int x) {
    switch (x) {
        case 1: {
            int local = 1;
            return local;
        }
        default: {
            int local = -1;
            int other = -2;
            return local + other;
        }
    }
}

// 8. default 穿透到 case
int test_default_fallthrough(int x) {
    int result = 0;
    switch (x) {
        case 1:
            result = 1;
            break;
        default:
            result = 100;
            // 穿透到 case 2
        case 2:
            result = result + 2;
            break;
    }
    return result;
}

// 9. case 穿透到 default
int test_case_to_default(int x) {
    int result = 0;
    switch (x) {
        case 1:
            result = 1;
            // 穿透到 default
        default:
            result = result + 10;
    }
    return result;
}

// 10. default 用于错误处理
int test_default_error(int code) {
    switch (code) {
        case 0:
            return 0;  // 成功
        case 1:
            return 1;  // 警告
        case 2:
            return 2;  // 错误
        default:
            return -1; // 未知代码，错误
    }
}

// 11. default 用于无效输入
const char* get_day_name(int day) {
    switch (day) {
        case 0:
            return "Sunday";
        case 1:
            return "Monday";
        case 2:
            return "Tuesday";
        case 3:
            return "Wednesday";
        case 4:
            return "Thursday";
        case 5:
            return "Friday";
        case 6:
            return "Saturday";
        default:
            return "Invalid day";
    }
}

// 12. default 用于默认值
int get_value_or_default(int key) {
    switch (key) {
        case 1:
            return 100;
        case 2:
            return 200;
        case 3:
            return 300;
        default:
            return 0;  // 默认值
    }
}

// 13. default 空语句
int test_default_empty(int x) {
    switch (x) {
        case 1:
            return 1;
        default:
            ;  // 空语句
    }
    return 0;
}

// 14. 只有 default
int test_only_default(int x) {
    switch (x) {
        default:
            return -1;
    }
}

// 15. default 与枚举
enum Color {
    RED,
    GREEN,
    BLUE
};

const char* color_to_string(enum Color c) {
    switch (c) {
        case RED:
            return "Red";
        case GREEN:
            return "Green";
        case BLUE:
            return "Blue";
        default:
            return "Unknown color";  // 处理无效枚举值
    }
}

// 16. default 处理越界
int safe_array_access(int arr[], int size, int index) {
    switch (index >= 0 && index < size) {
        case 1:
            return arr[index];
        default:
            return -1;  // 越界
    }
}

// 17. default 用于类型分发
int handle_type(int type) {
    switch (type) {
        case 1:
            return 10;
        case 2:
            return 20;
        case 3:
            return 30;
        default:
            return 0;  // 未知类型
    }
}

// 18. default 与嵌套 switch
int nested_switch_default(int x, int y) {
    switch (x) {
        case 1:
            switch (y) {
                case 1:
                    return 11;
                default:
                    return 10;
            }
        case 2:
            switch (y) {
                case 1:
                    return 21;
                case 2:
                    return 22;
                default:
                    return 20;
            }
        default:
            switch (y) {
                case 1:
                    return 1;
                default:
                    return 0;
            }
    }
}

// 19. default 与 return
int direct_default_return(int x) {
    switch (x) {
        case 0:
            return 0;
        case 1:
            return 1;
        default:
            return -1;  // 直接返回
    }
    // 不可达
}

// 20. default 设置状态
enum Status {
    STATUS_OK,
    STATUS_ERROR,
    STATUS_UNKNOWN
};

enum Status parse_code(int code) {
    switch (code) {
        case 0:
            return STATUS_OK;
        case 1:
        case 2:
        case 3:
            return STATUS_ERROR;
        default:
            return STATUS_UNKNOWN;
    }
}

// 21. default 与计算
int calculate_with_default(int op, int a, int b) {
    switch (op) {
        case '+':
            return a + b;
        case '-':
            return a - b;
        case '*':
            return a * b;
        case '/':
            return b != 0 ? a / b : 0;
        default:
            return a;  // 默认返回第一个操作数
    }
}

// 22. default 与标志位
int check_flag(int flags) {
    switch (flags & 0x07) {
        case 0:
            return 0;
        case 1:
            return 1;
        case 2:
            return 2;
        case 4:
            return 4;
        default:
            return -1;  // 多个标志位设置
    }
}

// 23. default 日志级别
const char* get_log_level(int level) {
    switch (level) {
        case 0:
            return "TRACE";
        case 1:
            return "DEBUG";
        case 2:
            return "INFO";
        case 3:
            return "WARN";
        case 4:
            return "ERROR";
        case 5:
            return "FATAL";
        default:
            return "UNKNOWN";
    }
}

// 24. default 菜单选择
int menu_select(int choice) {
    switch (choice) {
        case 1:
            return 100;  // 选项 1
        case 2:
            return 200;  // 选项 2
        case 3:
            return 300;  // 选项 3
        case 0:
            return 0;    // 退出
        default:
            return -1;   // 无效选择，返回错误
    }
}

// 25. default 协议版本
int handle_protocol(int version) {
    switch (version) {
        case 1:
            return 1;  // v1 处理
        case 2:
            return 2;  // v2 处理
        case 3:
            return 3;  // v3 处理
        default:
            return 0;  // 不支持的版本
    }
}

int main(void) {
    int x = 5;
    int result;
    
    // default 作为回退
    switch (x) {
        case 1:
            result = 1;
            break;
        case 2:
            result = 2;
            break;
        default:
            result = -1;  // x = 5，走这里
    }
    
    // default 处理未知输入
    const char* day = get_day_name(10);  // 返回 "Invalid day"
    
    return 0;
}
